<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>실시간 날씨 앱</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }

        .search-input {
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            width: 300px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            outline: none;
        }

        .search-btn, .location-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 25px;
            background: #00b894;
            color: white;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .search-btn:hover, .location-btn:hover {
            background: #00a085;
            transform: translateY(-2px);
        }

        .weather-main {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .current-weather {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .weather-info {
            flex: 1;
        }

        .city-name {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #2d3436;
        }

        .temperature {
            font-size: 4rem;
            font-weight: bold;
            color: #0984e3;
            margin-bottom: 10px;
        }

        .description {
            font-size: 1.2rem;
            color: #636e72;
            text-transform: capitalize;
        }

        .weather-icon {
            font-size: 6rem;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .detail-item {
            text-align: center;
            padding: 15px;
            background: rgba(116, 185, 255, 0.1);
            border-radius: 10px;
        }

        .detail-label {
            font-size: 0.9rem;
            color: #636e72;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2d3436;
        }

        .forecast-container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .forecast-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            color: #2d3436;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .forecast-item {
            background: rgba(116, 185, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }

        .forecast-item:hover {
            transform: translateY(-5px);
        }

        .forecast-date {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2d3436;
        }

        .forecast-icon {
            font-size: 2.5rem;
            margin: 10px 0;
        }

        .forecast-temp {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .forecast-desc {
            font-size: 0.9rem;
            color: #636e72;
            text-transform: capitalize;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            margin: 50px 0;
        }

        .error {
            background: #ff7675;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .recent-searches {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .recent-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #2d3436;
        }

        .recent-item {
            display: inline-block;
            background: #74b9ff;
            color: white;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .recent-item:hover {
            background: #0984e3;
        }

        @media (max-width: 768px) {
            .search-input {
                width: 250px;
            }
            
            .current-weather {
                text-align: center;
            }
            
            .temperature {
                font-size: 3rem;
            }
            
            .weather-icon {
                font-size: 4rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌤️ 실시간 날씨</h1>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="도시명을 입력하세요..." id="cityInput">
            <button class="search-btn" onclick="searchWeather()">검색</button>
            <button class="location-btn" onclick="getCurrentLocation()">현재 위치</button>
        </div>

        <div id="recentSearches" class="recent-searches" style="display: none;">
            <div class="recent-title">최근 검색</div>
            <div id="recentList"></div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            날씨 정보를 불러오는 중...
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div id="weatherMain" class="weather-main" style="display: none;">
            <div class="current-weather">
                <div class="weather-info">
                    <div class="city-name" id="cityName"></div>
                    <div class="temperature" id="temperature"></div>
                    <div class="description" id="description"></div>
                </div>
                <div class="weather-icon" id="weatherIcon"></div>
            </div>
            
            <div class="weather-details">
                <div class="detail-item">
                    <div class="detail-label">체감온도</div>
                    <div class="detail-value" id="feelsLike"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">습도</div>
                    <div class="detail-value" id="humidity"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">풍속</div>
                    <div class="detail-value" id="windSpeed"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">기압</div>
                    <div class="detail-value" id="pressure"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">가시거리</div>
                    <div class="detail-value" id="visibility"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">자외선 지수</div>
                    <div class="detail-value" id="uvIndex"></div>
                </div>
            </div>
        </div>

        <div id="forecastContainer" class="forecast-container" style="display: none;">
            <div class="forecast-title">5일 날씨 예보</div>
            <div class="forecast-grid" id="forecastGrid"></div>
        </div>
    </div>

    <script>
        // API 키 - 실제 사용시에는 본인의 OpenWeather API 키로 교체해야 합니다
        const API_KEY = 'YOUR_API_KEY_HERE';
        const BASE_URL = 'https://api.openweathermap.org/data/2.5';
        
        // 최근 검색 기록을 저장할 변수 (LocalStorage 대신 메모리 사용)
        let recentSearches = [];

        // 페이지 로드시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // Enter 키로 검색 가능하도록 설정
            document.getElementById('cityInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchWeather();
                }
            });
            
            // 데모용 API 키 안내
            if (API_KEY === 'YOUR_API_KEY_HERE') {
                showError('API 키가 설정되지 않았습니다. OpenWeather API 키를 설정해주세요.');
                return;
            }
            
            // 서울 날씨를 기본으로 표시
            getWeather('Seoul');
        });

        // 도시 검색
        function searchWeather() {
            const cityName = document.getElementById('cityInput').value.trim();
            if (cityName) {
                getWeather(cityName);
                addToRecentSearches(cityName);
                document.getElementById('cityInput').value = '';
            }
        }

        // 현재 위치 날씨
        function getCurrentLocation() {
            if (navigator.geolocation) {
                showLoading(true);
                navigator.geolocation.getCurrentPosition(
                    position => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        getWeatherByCoords(lat, lon);
                    },
                    error => {
                        showError('위치 정보를 가져올 수 없습니다.');
                        showLoading(false);
                    }
                );
            } else {
                showError('이 브라우저는 위치 서비스를 지원하지 않습니다.');
            }
        }

        // 도시명으로 날씨 정보 가져오기
        async function getWeather(cityName) {
            showLoading(true);
            try {
                const response = await fetch(`${BASE_URL}/weather?q=${cityName}&appid=${API_KEY}&units=metric&lang=kr`);
                if (!response.ok) {
                    throw new Error('도시를 찾을 수 없습니다.');
                }
                const data = await response.json();
                displayCurrentWeather(data);
                getForecast(data.coord.lat, data.coord.lon);
            } catch (error) {
                showError(error.message);
                showLoading(false);
            }
        }

        // 좌표로 날씨 정보 가져오기
        async function getWeatherByCoords(lat, lon) {
            try {
                const response = await fetch(`${BASE_URL}/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=kr`);
                if (!response.ok) {
                    throw new Error('날씨 정보를 가져올 수 없습니다.');
                }
                const data = await response.json();
                displayCurrentWeather(data);
                getForecast(lat, lon);
                addToRecentSearches(data.name);
            } catch (error) {
                showError(error.message);
                showLoading(false);
            }
        }

        // 5일 예보 가져오기
        async function getForecast(lat, lon) {
            try {
                const response = await fetch(`${BASE_URL}/forecast?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=kr`);
                if (!response.ok) {
                    throw new Error('예보 정보를 가져올 수 없습니다.');
                }
                const data = await response.json();
                displayForecast(data);
                showLoading(false);
            } catch (error) {
                showError(error.message);
                showLoading(false);
            }
        }

        // 현재 날씨 표시
        function displayCurrentWeather(data) {
            document.getElementById('cityName').textContent = `${data.name}, ${data.sys.country}`;
            document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}°C`;
            document.getElementById('description').textContent = data.weather[0].description;
            document.getElementById('weatherIcon').textContent = getWeatherEmoji(data.weather[0].icon);
            
            document.getElementById('feelsLike').textContent = `${Math.round(data.main.feels_like)}°C`;
            document.getElementById('humidity').textContent = `${data.main.humidity}%`;
            document.getElementById('windSpeed').textContent = `${data.wind.speed} m/s`;
            document.getElementById('pressure').textContent = `${data.main.pressure} hPa`;
            document.getElementById('visibility').textContent = `${(data.visibility / 1000).toFixed(1)} km`;
            
            // UV 인덱스는 별도 API 호출이 필요하므로 임시값
            document.getElementById('uvIndex').textContent = 'N/A';
            
            document.getElementById('weatherMain').style.display = 'block';
        }

        // 5일 예보 표시
        function displayForecast(data) {
            const forecastGrid = document.getElementById('forecastGrid');
            forecastGrid.innerHTML = '';
            
            // 매일 하나씩만 표시 (정오 시간대 기준)
            const dailyForecasts = {};
            data.list.forEach(item => {
                const date = new Date(item.dt * 1000);
                const dateKey = date.toDateString();
                
                if (!dailyForecasts[dateKey] || date.getHours() === 12) {
                    dailyForecasts[dateKey] = item;
                }
            });
            
            const forecasts = Object.values(dailyForecasts).slice(0, 5);
            
            forecasts.forEach(item => {
                const date = new Date(item.dt * 1000);
                const forecastItem = document.createElement('div');
                forecastItem.className = 'forecast-item';
                
                forecastItem.innerHTML = `
                    <div class="forecast-date">${formatDate(date)}</div>
                    <div class="forecast-icon">${getWeatherEmoji(item.weather[0].icon)}</div>
                    <div class="forecast-temp">${Math.round(item.main.temp)}°C</div>
                    <div class="forecast-desc">${item.weather[0].description}</div>
                `;
                
                forecastGrid.appendChild(forecastItem);
            });
            
            document.getElementById('forecastContainer').style.display = 'block';
        }

        // 최근 검색에 추가
        function addToRecentSearches(cityName) {
            if (!recentSearches.includes(cityName)) {
                recentSearches.unshift(cityName);
                if (recentSearches.length > 5) {
                    recentSearches.pop();
                }
                displayRecentSearches();
            }
        }

        // 최근 검색 표시
        function displayRecentSearches() {
            if (recentSearches.length > 0) {
                const recentList = document.getElementById('recentList');
                recentList.innerHTML = recentSearches.map(city => 
                    `<span class="recent-item" onclick="getWeather('${city}')">${city}</span>`
                ).join('');
                document.getElementById('recentSearches').style.display = 'block';
            }
        }

        // 날씨 아이콘을 이모지로 변환
        function getWeatherEmoji(iconCode) {
            const iconMap = {
                '01d': '☀️', '01n': '🌙',
                '02d': '⛅', '02n': '☁️',
                '03d': '☁️', '03n': '☁️',
                '04d': '☁️', '04n': '☁️',
                '09d': '🌧️', '09n': '🌧️',
                '10d': '🌦️', '10n': '🌦️',
                '11d': '⛈️', '11n': '⛈️',
                '13d': '❄️', '13n': '❄️',
                '50d': '🌫️', '50n': '🌫️'
            };
            return iconMap[iconCode] || '🌤️';
        }

        // 날짜 포맷
        function formatDate(date) {
            const options = { 
                month: 'short', 
                day: 'numeric',
                weekday: 'short'
            };
            return date.toLocaleDateString('ko-KR', options);
        }

        // 로딩 표시
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            if (!show) {
                document.getElementById('error').style.display = 'none';
            }
        }

        // 에러 표시
        function showError(message) {
            document.getElementById('error').textContent = message;
            document.getElementById('error').style.display = 'block';
            document.getElementById('loading').style.display = 'none';
            document.getElementById('weatherMain').style.display = 'none';
            document.getElementById('forecastContainer').style.display = 'none';
        }
    </script>
</body>
</html>