<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Excel 통합 단축키 키보드</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0F4C75, #3282B8, #4CAF50);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-decoration: none;
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-item {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 5px;
            margin: 20px auto;
            width: fit-content;
        }

        .mode-btn {
            background: transparent;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .mode-btn.active {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Search */
        .search-container {
            position: relative;
        }

        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 8px 15px;
            color: white;
            width: 200px;
            transition: all 0.3s ease;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-input:focus {
            outline: none;
            border-color: #1B9A59;
            box-shadow: 0 0 10px rgba(27, 154, 89, 0.3);
        }

        /* Breadcrumb */
        .breadcrumb {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 20px;
            margin-bottom: 20px;
        }

        .breadcrumb-content {
            max-width: 1200px;
            margin: 0 auto;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .breadcrumb a {
            color: #87CEEB;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        /* Main Content */
        .main-container {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            gap: 30px;
        }

        .main-content {
            flex: 1;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            height: fit-content;
            backdrop-filter: blur(5px);
        }

        .sidebar h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .sidebar-item {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            padding: 10px 15px;
            margin-bottom: 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .sidebar-item:hover {
            background: rgba(27, 154, 89, 0.3);
            color: white;
        }

        .title {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .keyboard {
            background: rgba(255, 255, 255, 0.15);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }

        .row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
            gap: 4px;
        }

        .key {
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.2);
            color: white;
            font-size: 11px;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 8px 4px;
            min-height: 50px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .key:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .ctrl-key {
            background: linear-gradient(135deg, #1B9A59, #27AE60);
        }

        .shift-key {
            background: linear-gradient(135deg, #388E3C, #4CAF50);
        }

        .ctrl-shift-key {
            background: linear-gradient(135deg, #E91E63, #AD1457);
            border-color: rgba(233, 30, 99, 0.5);
        }

        .both-key {
            background: linear-gradient(135deg, #1B9A59 0%, #388E3C 50%, #4CAF50 100%);
        }

        .inactive-key {
            background: linear-gradient(135deg, #374151, #4B5563);
            opacity: 0.4;
            cursor: default;
        }

        .inactive-key:hover {
            transform: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .special-key {
            background: linear-gradient(135deg, #4A5568, #6B7280);
        }

        /* 키 크기 */
        .key-normal { width: 50px; }
        .key-wide { width: 70px; }
        .key-wider { width: 90px; }
        .key-widest { width: 110px; }
        .key-space { width: 300px; }
        .key-shift { width: 120px; }
        .key-enter { width: 100px; height: 80px; }

        .korean-text {
            font-size: 9px;
            margin-top: 2px;
            opacity: 0.8;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            top: -45px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.95);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 13px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 2000;
            border: 2px solid rgba(27, 154, 89, 0.5);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            pointer-events: none;
            max-width: 320px;
            text-align: center;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: rgba(0,0,0,0.95);
        }

        .key:hover .tooltip {
            opacity: 1;
            visibility: visible;
            top: -55px;
        }

        .key.active .tooltip {
            opacity: 1;
            visibility: visible;
            top: -55px;
        }

        /* 첫 번째 행(Function Keys)의 키들은 툴팁을 아래쪽으로 표시 */
        .row:first-child .tooltip {
            top: 65px;
            transform: translateX(-50%);
        }

        .row:first-child .tooltip::after {
            top: -16px;
            border-top-color: transparent;
            border-bottom-color: rgba(0,0,0,0.95);
        }

        .row:first-child .key:hover .tooltip {
            top: 75px;
        }

        .row:first-child .key.active .tooltip {
            top: 75px;
        }

        @media (max-width: 768px) {
            .tooltip {
                font-size: 11px;
                padding: 8px 12px;
                max-width: 200px;
                white-space: normal;
                text-align: center;
            }
            
            .key:hover .tooltip {
                opacity: 0;
                visibility: hidden;
            }
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-size: 14px;
        }

        .legend-color {
            width: 30px;
            height: 20px;
            border-radius: 5px;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .instructions {
            text-align: center;
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
            font-size: 16px;
        }

        /* Card UI */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            border-color: #1B9A59;
        }

        .card h4 {
            color: #2ECC71;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .card p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        /* CTA Button */
        .cta-container {
            text-align: center;
            margin: 40px 0;
        }

        .cta-button {
            background: linear-gradient(135deg, #1B9A59 0%, #27AE60 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #27AE60 0%, #1B9A59 100%);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: rgba(15, 76, 117, 0.95);
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            color: white;
            backdrop-filter: blur(10px);
            transform: scale(0.7);
            transition: all 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.3);
            color: rgba(255, 255, 255, 0.8);
            padding: 40px 0 20px 0;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h4 {
            color: white;
            margin-bottom: 15px;
        }

        .footer-section a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: block;
            margin-bottom: 8px;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: #2ECC71;
        }

        .footer-bottom {
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin-top: 30px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .nav {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">📊 Excel 통합 단축키</a>
            
            <!-- Navigation -->
            <nav class="nav">
                <a href="#" class="nav-item">홈</a>
                <a href="#" class="nav-item">튜토리얼</a>
                <a href="#" class="nav-item" onclick="openModal()">도움말</a>
            </nav>
            
            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="단축키 검색...">
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="#">홈</a> > <a href="#">Microsoft Office</a> > <span>Excel 통합 단축키</span>
        </div>
    </div>

    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>📋 단축키 종류</h3>
            <a href="#" class="sidebar-item" onclick="showMode('ctrl')">📊 Ctrl 단축키</a>
            <a href="#" class="sidebar-item" onclick="showMode('shift')">⇧ Shift 단축키</a>
            <a href="#" class="sidebar-item" onclick="showMode('ctrl-shift')">⚡ Ctrl+Shift 단축키</a>
            <a href="#" class="sidebar-item" onclick="showMode('all')">🔄 전체 보기</a>
            
            <h3 style="margin-top: 30px;">📁 카테고리</h3>
            <a href="#" class="sidebar-item">📋 데이터 입력</a>
            <a href="#" class="sidebar-item">🧮 계산 & 수식</a>
            <a href="#" class="sidebar-item">📊 차트 & 그래프</a>
            <a href="#" class="sidebar-item">🔍 필터 & 정렬</a>
            <a href="#" class="sidebar-item">📄 워크시트 관리</a>
            
            <h3 style="margin-top: 30px;">🔗 빠른 링크</h3>
            <a href="#" class="sidebar-item">인기 단축키 Top 10</a>
            <a href="#" class="sidebar-item">초보자 가이드</a>
            <a href="#" class="sidebar-item">단축키 연습</a>
            <a href="#" class="sidebar-item">PDF 다운로드</a>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="title">Microsoft Excel 통합 단축키 키보드</div>
            
            <!-- Mode Selector -->
            <div class="mode-selector">
                <button class="mode-btn active" id="ctrl-btn" onclick="showMode('ctrl')">Ctrl 단축키</button>
                <button class="mode-btn" id="shift-btn" onclick="showMode('shift')">Shift 단축키</button>
                <button class="mode-btn" id="ctrl-shift-btn" onclick="showMode('ctrl-shift')">Ctrl+Shift 단축키</button>
                <button class="mode-btn" id="all-btn" onclick="showMode('all')">전체 보기</button>
            </div>
            
            <div class="instructions" id="instructions">
                컬러 키에 마우스를 올리면 Excel 단축키 정보를 확인할 수 있습니다 (초록=Ctrl, 연두=Shift, 분홍=Ctrl+Shift)
            </div>

            <div class="legend" id="legend">
                <div class="legend-item">
                    <div class="legend-color ctrl-key"></div>
                    <span>Ctrl 단축키</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color shift-key"></div>
                    <span>Shift 단축키</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color ctrl-shift-key"></div>
                    <span>Ctrl+Shift 단축키</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color both-key"></div>
                    <span>다중 조합 키</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color inactive-key"></div>
                    <span>일반 키</span>
                </div>
            </div>

            <div class="keyboard">
                <!-- Function Keys Row -->
                <div class="row">
                    <div class="key both-key key-normal">F1<div class="korean-text">도움말</div>
                        <div class="tooltip">Ctrl+F1: 리본 메뉴 표시/숨기기<br>Shift+F1: Excel 도움말<br>Ctrl+Shift+F1: 상황별 도움말</div>
                    </div>
                    <div class="key both-key key-normal">F2<div class="korean-text">인쇄/편집</div>
                        <div class="tooltip">Ctrl+F2: 인쇄 미리보기<br>Shift+F2: 메모 추가/편집<br>Ctrl+Shift+F2: 메모 추가/편집</div>
                    </div>
                    <div class="key both-key key-normal">F3<div class="korean-text">이름정의/함수</div>
                        <div class="tooltip">Ctrl+F3: 이름 관리자<br>Shift+F3: 함수 삽입<br>Ctrl+Shift+F3: 이름으로부터 이름 만들기</div>
                    </div>
                    <div class="key both-key key-normal">F4<div class="korean-text">닫기/이전찾기</div>
                        <div class="tooltip">Ctrl+F4: 통합문서 닫기<br>Shift+F4: 이전 찾기</div>
                    </div>
                    <div class="key shift-key key-normal">F5<div class="korean-text">찾기</div>
                        <div class="tooltip">Shift+F5: 찾기 및 바꾸기</div>
                    </div>
                    <div class="key both-key key-normal">F6<div class="korean-text">창전환</div>
                        <div class="tooltip">Ctrl+F6: 창 전환<br>Shift+F6: 이전 창</div>
                    </div>
                    <div class="key shift-key key-normal">F7<div class="korean-text">맞춤법</div>
                        <div class="tooltip">Shift+F7: 맞춤법 검사</div>
                    </div>
                    <div class="key shift-key key-normal">F8<div class="korean-text">선택축소</div>
                        <div class="tooltip">Shift+F8: 선택 영역 축소</div>
                    </div>
                    <div class="key shift-key key-normal">F9<div class="korean-text">계산</div>
                        <div class="tooltip">Shift+F9: 활성 시트 계산</div>
                    </div>
                    <div class="key both-key key-normal">F10<div class="korean-text">최대화/메뉴</div>
                        <div class="tooltip">Ctrl+F10: 창 최대화<br>Shift+F10: 상황별 메뉴</div>
                    </div>
                    <div class="key shift-key key-normal">F11<div class="korean-text">새시트</div>
                        <div class="tooltip">Shift+F11: 새 워크시트 삽입</div>
                    </div>
                    <div class="key both-key key-normal">F12<div class="korean-text">저장</div>
                        <div class="tooltip">Ctrl+F12: 다른 이름으로 저장<br>Shift+F12: 저장</div>
                    </div>
                </div>

                <!-- Number Row -->
                <div class="row">
                    <div class="key ctrl-shift-key key-normal">~<div class="korean-text">일반서식</div>
                        <div class="tooltip">Ctrl+Shift+~: 일반 숫자 서식 적용</div>
                    </div>
                    <div class="key both-key key-normal">1<div class="korean-text">셀서식/숫자</div>
                        <div class="tooltip">Ctrl+1: 셀 서식 대화상자<br>Shift+1: ! (느낌표)<br>Ctrl+Shift+1: 숫자 서식 (소수점 2자리)</div>
                    </div>
                    <div class="key both-key key-normal">2<div class="korean-text">굵게/시간</div>
                        <div class="tooltip">Ctrl+2: 굵게<br>Shift+2: @ (골뱅이)<br>Ctrl+Shift+2: 시간 서식 (h:mm)</div>
                    </div>
                    <div class="key both-key key-normal">3<div class="korean-text">기울임/날짜</div>
                        <div class="tooltip">Ctrl+3: 기울임꼴<br>Shift+3: # (샵)<br>Ctrl+Shift+3: 날짜 서식 (d-mmm-yy)</div>
                    </div>
                    <div class="key both-key key-normal">4<div class="korean-text">밑줄/통화</div>
                        <div class="tooltip">Ctrl+4: 밑줄<br>Shift+4: $ (절대참조)<br>Ctrl+Shift+4: 통화 서식</div>
                    </div>
                    <div class="key both-key key-normal">5<div class="korean-text">취소선/백분율</div>
                        <div class="tooltip">Ctrl+5: 취소선<br>Shift+5: % (퍼센트)<br>Ctrl+Shift+5: 백분율 서식</div>
                    </div>
                    <div class="key both-key key-normal">6<div class="korean-text">숨기기/지수</div>
                        <div class="tooltip">Ctrl+6: 개체 숨기기<br>Shift+6: ^ (지수)<br>Ctrl+Shift+6: 지수 서식</div>
                    </div>
                    <div class="key ctrl-shift-key key-normal">7<div class="korean-text">윤곽선</div>
                        <div class="tooltip">Ctrl+Shift+7: 윤곽선 테두리 적용</div>
                    </div>
                    <div class="key ctrl-shift-key key-normal">8<div class="korean-text">현재영역</div>
                        <div class="tooltip">Ctrl+Shift+8: 현재 데이터 영역 선택</div>
                    </div>
                    <div class="key both-key key-normal">9<div class="korean-text">행숨기기/해제</div>
                        <div class="tooltip">Ctrl+9: 선택한 행 숨기기<br>Shift+9: ( (여는 괄호)<br>Ctrl+Shift+9: 숨겨진 행 표시</div>
                    </div>
                    <div class="key both-key key-normal">0<div class="korean-text">열숨기기/해제</div>
                        <div class="tooltip">Ctrl+0: 선택한 열 숨기기<br>Shift+0: ) (닫는 괄호)<br>Ctrl+Shift+0: 숨겨진 열 표시</div>
                    </div>
                    <div class="key both-key key-normal">-<div class="korean-text">삭제</div>
                        <div class="tooltip">Ctrl+-: 셀/행/열 삭제<br>Shift+-: _ (밑줄)<br>Ctrl+Shift+-: 값 삭제</div>
                    </div>
                    <div class="key both-key key-normal">=<div class="korean-text">삽입</div>
                        <div class="tooltip">Ctrl+Shift+=: 셀/행/열 삽입<br>Shift+=: + (더하기)</div>
                    </div>
                    <div class="key special-key key-wide">Back<div class="korean-text">백스페이스</div>
                        <div class="tooltip">백스페이스: 이전 문자 삭제</div>
                    </div>
                </div>

                <!-- Top Row (QWERTY) -->
                <div class="row">
                    <div class="key special-key key-wider">Tab<div class="korean-text">탭</div>
                        <div class="tooltip">Tab: 다음 셀로 이동<br>Shift+Tab: 이전 셀로 이동</div>
                    </div>
                    <div class="key both-key key-normal">Q<div class="korean-text">ㅂ</div>
                        <div class="tooltip">Ctrl+Shift+Q: 빠른 분석 도구</div>
                    </div>
                    <div class="key inactive-key key-normal">W<div class="korean-text">ㅈ</div></div>
                    <div class="key both-key key-normal">E<div class="korean-text">ㄷ</div>
                        <div class="tooltip">Ctrl+E: 플래시 채우기<br>Ctrl+Shift+E: 피벗 테이블 필드</div>
                    </div>
                    <div class="key both-key key-normal">R<div class="korean-text">ㄱ</div>
                        <div class="tooltip">Ctrl+R: 오른쪽 채우기<br>Ctrl+Shift+R: 행 그룹 해제</div>
                    </div>
                    <div class="key both-key key-normal">T<div class="korean-text">ㅅ</div>
                        <div class="tooltip">Ctrl+T: 표 만들기<br>Ctrl+Shift+T: 표 디자인 탭</div>
                    </div>
                    <div class="key inactive-key key-normal">Y<div class="korean-text">ㅛ</div></div>
                    <div class="key both-key key-normal">U<div class="korean-text">ㅕ</div>
                        <div class="tooltip">Ctrl+Shift+U: 수식 입력줄 확장/축소</div>
                    </div>
                    <div class="key inactive-key key-normal">I<div class="korean-text">ㅑ</div></div>
                    <div class="key ctrl-key key-normal">O<div class="korean-text">ㅎ</div>
                        <div class="tooltip">Ctrl+O: 열기</div>
                    </div>
                    <div class="key both-key key-normal">P<div class="korean-text">ㅗ</div>
                        <div class="tooltip">Ctrl+P: 인쇄<br>Ctrl+Shift+P: 글꼴 크기 선택</div>
                    </div>
                    <div class="key inactive-key key-normal">[<div class="korean-text">{</div></div>
                    <div class="key inactive-key key-normal">]<div class="korean-text">}</div></div>
                    <div class="key inactive-key key-normal">\\<div class="korean-text">|</div></div>
                </div>

                <!-- Middle Row (ASDF) -->
                <div class="row">
                    <div class="key special-key key-widest">CapsLock<div class="korean-text">한/영</div>
                        <div class="tooltip">CapsLock: 대소문자 전환</div>
                    </div>
                    <div class="key both-key key-normal">A<div class="korean-text">ㅁ</div>
                        <div class="tooltip">Ctrl+A: 전체 선택<br>Ctrl+Shift+A: 함수 인수 삽입</div>
                    </div>
                    <div class="key both-key key-normal">S<div class="korean-text">ㄴ</div>
                        <div class="tooltip">Ctrl+S: 저장<br>Ctrl+Shift+S: 다른 이름으로 저장</div>
                    </div>
                    <div class="key both-key key-normal">D<div class="korean-text">ㅇ</div>
                        <div class="tooltip">Ctrl+D: 아래쪽 채우기<br>Ctrl+Shift+D: 중복 제거</div>
                    </div>
                    <div class="key both-key key-normal">F<div class="korean-text">ㄹ</div>
                        <div class="tooltip">Ctrl+F: 찾기 및 바꾸기<br>Ctrl+Shift+F: 글꼴 선택</div>
                    </div>
                    <div class="key both-key key-normal">G<div class="korean-text">ㅎ</div>
                        <div class="tooltip">Ctrl+G: 이동 대화상자<br>Ctrl+Shift+G: 그룹화</div>
                    </div>
                    <div class="key both-key key-normal">H<div class="korean-text">ㅗ</div>
                        <div class="tooltip">Ctrl+H: 바꾸기<br>Ctrl+Shift+H: 모든 바꾸기</div>
                    </div>
                    <div class="key inactive-key key-normal">J<div class="korean-text">ㅓ</div></div>
                    <div class="key inactive-key key-normal">K<div class="korean-text">ㅏ</div></div>
                    <div class="key both-key key-normal">L<div class="korean-text">ㅣ</div>
                        <div class="tooltip">Ctrl+L: 표 만들기<br>Ctrl+Shift+L: 자동 필터</div>
                    </div>
                    <div class="key inactive-key key-normal">;<div class="korean-text">:</div></div>
                    <div class="key inactive-key key-normal">'<div class="korean-text">"</div></div>
                    <div class="key special-key key-enter">Enter<div class="korean-text">엔터</div>
                        <div class="tooltip">Enter: 아래 셀로 이동<br>Shift+Enter: 위쪽 셀로 이동<br>Ctrl+Shift+Enter: 배열 수식 입력</div>
                    </div>
                </div>

                <!-- Bottom Row (ZXCV) -->
                <div class="row">
                    <div class="key special-key key-shift">Shift<div class="korean-text">시프트</div>
                        <div class="tooltip">Shift: 범위 선택 및 다양한 조합키</div>
                    </div>
                    <div class="key both-key key-normal">Z<div class="korean-text">ㅋ</div>
                        <div class="tooltip">Ctrl+Z: 실행 취소<br>Ctrl+Shift+Z: 다시 실행</div>
                    </div>
                    <div class="key both-key key-normal">X<div class="korean-text">ㅌ</div>
                        <div class="tooltip">Ctrl+X: 잘라내기<br>Ctrl+Shift+X: 워크시트 보호</div>
                    </div>
                    <div class="key both-key key-normal">C<div class="korean-text">ㅊ</div>
                        <div class="tooltip">Ctrl+C: 복사<br>Ctrl+Shift+C: 서식 복사</div>
                    </div>
                    <div class="key both-key key-normal">V<div class="korean-text">ㅍ</div>
                        <div class="tooltip">Ctrl+V: 붙여넣기<br>Ctrl+Shift+V: 선택하여 붙여넣기</div>
                    </div>
                    <div class="key inactive-key key-normal">B<div class="korean-text">ㅠ</div></div>
                    <div class="key both-key key-normal">N<div class="korean-text">ㅜ</div>
                        <div class="tooltip">Ctrl+N: 새 통합문서<br>Ctrl+Shift+N: 새 워크시트</div>
                    </div>
                    <div class="key inactive-key key-normal">M<div class="korean-text">ㅡ</div></div>
                    <div class="key inactive-key key-normal">,<div class="korean-text"><</div></div>
                    <div class="key inactive-key key-normal">.<div class="korean-text">></div></div>
                    <div class="key inactive-key key-normal">/<div class="korean-text">?</div></div>
                    <div class="key special-key key-shift">Shift<div class="korean-text">시프트</div>
                        <div class="tooltip">Shift: 범위 선택 및 다양한 조합키</div>
                    </div>
                </div>

                <!-- Control Row -->
                <div class="row">
                    <div class="key special-key key-wider">Ctrl<div class="korean-text">컨트롤</div>
                        <div class="tooltip">Ctrl: 주요 Excel 단축키 조합</div>
                    </div>
                    <div class="key special-key key-wider">Win<div class="korean-text">윈도우</div>
                        <div class="tooltip">Windows: 시작 메뉴</div>
                    </div>
                    <div class="key special-key key-wider">Alt<div class="korean-text">알트</div>
                        <div class="tooltip">Alt: 액세스키 활성화</div>
                    </div>
                    <div class="key special-key key-space">Space<div class="korean-text">스페이스</div>
                        <div class="tooltip">Space: 공백<br>Ctrl+Space: 열 전체 선택<br>Shift+Space: 행 전체 선택<br>Ctrl+Shift+Space: 전체 워크시트</div>
                    </div>
                    <div class="key special-key key-wider">Alt<div class="korean-text">알트</div>
                        <div class="tooltip">Alt: 액세스키 활성화</div>
                    </div>
                    <div class="key special-key key-wider">Menu<div class="korean-text">메뉴</div>
                        <div class="tooltip">Menu: 상황별 메뉴</div>
                    </div>
                    <div class="key special-key key-wider">Ctrl<div class="korean-text">컨트롤</div>
                        <div class="tooltip">Ctrl: 주요 Excel 단축키 조합</div>
                    </div>
                </div>

                <!-- Arrow Keys -->
                <div class="row" style="margin-top: 20px;">
                    <div style="width: 200px;"></div>
                    <div class="key both-key key-normal">↑<div class="korean-text">위</div>
                        <div class="tooltip">↑: 위쪽 셀<br>Ctrl+↑: 데이터 영역 맨 위<br>Shift+↑: 위쪽으로 선택<br>Ctrl+Shift+↑: 데이터 끝까지 선택</div>
                    </div>
                </div>
                <div class="row">
                    <div style="width: 150px;"></div>
                    <div class="key both-key key-normal">←<div class="korean-text">왼</div>
                        <div class="tooltip">←: 왼쪽 셀<br>Ctrl+←: 데이터 영역 왼쪽 끝<br>Shift+←: 왼쪽으로 선택<br>Ctrl+Shift+←: 데이터 끝까지 선택</div>
                    </div>
                    <div class="key both-key key-normal">↓<div class="korean-text">아래</div>
                        <div class="tooltip">↓: 아래쪽 셀<br>Ctrl+↓: 데이터 영역 맨 아래<br>Shift+↓: 아래쪽으로 선택<br>Ctrl+Shift+↓: 데이터 끝까지 선택</div>
                    </div>
                    <div class="key both-key key-normal">→<div class="korean-text">오른</div>
                        <div class="tooltip">→: 오른쪽 셀<br>Ctrl+→: 데이터 영역 오른쪽 끝<br>Shift+→: 오른쪽으로 선택<br>Ctrl+Shift+→: 데이터 끝까지 선택</div>
                    </div>
                </div>

                <!-- Additional Keys -->
                <div class="row" style="margin-top: 20px;">
                    <div class="key both-key key-normal">Home<div class="korean-text">홈</div>
                        <div class="tooltip">Home: 행 맨 앞<br>Ctrl+Home: A1 셀<br>Shift+Home: 행 시작까지 선택</div>
                    </div>
                    <div class="key both-key key-normal">End<div class="korean-text">끝</div>
                        <div class="tooltip">End: 행 맨 끝<br>Ctrl+End: 마지막 데이터 셀<br>Shift+End: 행 끝까지 선택</div>
                    </div>
                    <div class="key both-key key-normal">PgUp<div class="korean-text">위쪽</div>
                        <div class="tooltip">Page Up: 한 화면 위<br>Ctrl+Page Up: 이전 워크시트<br>Shift+Page Up: 한 화면 위까지 선택</div>
                    </div>
                    <div class="key both-key key-normal">PgDn<div class="korean-text">아래</div>
                        <div class="tooltip">Page Down: 한 화면 아래<br>Ctrl+Page Down: 다음 워크시트<br>Shift+Page Down: 한 화면 아래까지 선택</div>
                    </div>
                    <div class="key special-key key-normal">Del<div class="korean-text">삭제</div>
                        <div class="tooltip">Delete: 셀 내용 삭제<br>Ctrl+Delete: 행 끝까지 삭제<br>Shift+Delete: 셀 삭제</div>
                    </div>
                    <div class="key special-key key-normal">Ins<div class="korean-text">삽입</div>
                        <div class="tooltip">Insert: 삽입 모드 전환</div>
                    </div>
                </div>
            </div>

            <!-- CTA Section -->
            <div class="cta-container">
                <button class="cta-button" onclick="openModal()">📚 Excel 마스터 가이드 보기</button>
            </div>

            <!-- Card UI -->
            <div class="cards-container">
                <div class="card">
                    <h4>📁 파일 관리 (Ctrl)</h4>
                    <p>
                    <strong>Ctrl + N:</strong> 새 통합문서<br>
                    <strong>Ctrl + O:</strong> 열기<br>
                    <strong>Ctrl + S:</strong> 저장<br>
                    <strong>Ctrl + W:</strong> 통합문서 닫기<br>
                    <strong>Ctrl + P:</strong> 인쇄<br>
                    <strong>Ctrl + F12:</strong> 다른 이름으로 저장
                    </p>
                </div>
                <div class="card">
                    <h4>✏️ 편집 및 입력</h4>
                    <p>
                    <strong>Ctrl + Z:</strong> 실행 취소<br>
                    <strong>Ctrl + Y:</strong> 다시 실행<br>
                    <strong>Ctrl + X:</strong> 잘라내기<br>
                    <strong>Ctrl + C:</strong> 복사<br>
                    <strong>Ctrl + V:</strong> 붙여넣기<br>
                    <strong>Shift + Enter:</strong> 위쪽 셀로 이동<br>
                    <strong>Shift + Tab:</strong> 이전 셀로 이동
                    </p>
                </div>
                <div class="card">
                    <h4>🎨 서식 지정 (Ctrl)</h4>
                    <p>
                    <strong>Ctrl + 1:</strong> 셀 서식 대화상자<br>
                    <strong>Ctrl + 2:</strong> 굵게<br>
                    <strong>Ctrl + 3:</strong> 기울임꼴<br>
                    <strong>Ctrl + 4:</strong> 밑줄<br>
                    <strong>Ctrl + 5:</strong> 취소선<br>
                    <strong>Ctrl + 9:</strong> 행 숨기기<br>
                    <strong>Ctrl + 0:</strong> 열 숨기기
                    </p>
                </div>
                <div class="card">
                    <h4>📊 데이터 및 표</h4>
                    <p>
                    <strong>Ctrl + T:</strong> 표 만들기<br>
                    <strong>Ctrl + L:</strong> 표 만들기<br>
                    <strong>Ctrl + E:</strong> 플래시 채우기<br>
                    <strong>Ctrl + D:</strong> 아래쪽 채우기<br>
                    <strong>Ctrl + R:</strong> 오른쪽 채우기<br>
                    <strong>Shift + F11:</strong> 새 워크시트 삽입<br>
                    <strong>Shift + F3:</strong> 함수 삽입
                    </p>
                </div>
                <div class="card">
                    <h4>🔍 검색 및 바꾸기</h4>
                    <p>
                    <strong>Ctrl + F:</strong> 찾기 및 바꾸기<br>
                    <strong>Ctrl + H:</strong> 바꾸기<br>
                    <strong>Ctrl + G:</strong> 이동 대화상자<br>
                    <strong>Shift + F4:</strong> 이전 찾기<br>
                    <strong>Shift + F5:</strong> 찾기 및 바꾸기<br>
                    <strong>Shift + F10:</strong> 상황별 메뉴
                    </p>
                </div>
                <div class="card">
                    <h4>🔧 고급 워크시트 관리</h4>
                    <p>
                    <strong>Ctrl+Shift+9:</strong> 숨겨진 행 표시<br>
                    <strong>Ctrl+Shift+0:</strong> 숨겨진 열 표시<br>
                    <strong>Ctrl+Shift+F:</strong> 글꼴 선택<br>
                    <strong>Ctrl+Shift+P:</strong> 글꼴 크기 선택<br>
                    <strong>Ctrl+Shift+U:</strong> 수식 입력줄 확장<br>
                    <strong>Ctrl+Shift+Q:</strong> 빠른 분석 도구
                    </p>
                </div>
                <div class="card">
                    <h4>🚀 이동 및 탐색 (Ctrl)</h4>
                    <p>
                    <strong>Ctrl + Home:</strong> A1 셀로 이동<br>
                    <strong>Ctrl + End:</strong> 마지막 데이터 셀<br>
                    <strong>Ctrl + ← / →:</strong> 데이터 영역 끝<br>
                    <strong>Ctrl + ↑ / ↓:</strong> 데이터 영역 끝<br>
                    <strong>Ctrl + Page Up/Down:</strong> 워크시트 전환
                    </p>
                </div>
                <div class="card">
                    <h4>🔢 셀 범위 선택 (Shift)</h4>
                    <p>
                    <strong>Shift + ↑/↓:</strong> 위아래 셀 선택<br>
                    <strong>Shift + ←/→:</strong> 좌우 셀 선택<br>
                    <strong>Shift + Ctrl + ←/→:</strong> 데이터 끝까지 선택<br>
                    <strong>Shift + Home/End:</strong> 행 처음/끝까지 선택<br>
                    <strong>Shift + Space:</strong> 행 전체 선택<br>
                    <strong>Shift + Ctrl + Space:</strong> 열 전체 선택
                    </p>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📊 Excel 통합 단축키 가이드</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <h3>🎯 Excel 단축키 마스터 가이드</h3>
                <p style="margin-bottom: 15px;">Excel Ctrl, Shift, Ctrl+Shift 단축키를 효과적으로 익히는 방법:</p>
                <ul style="margin-left: 20px; margin-bottom: 20px;">
                    <li style="margin-bottom: 8px;"><strong>Ctrl 키:</strong> 빠른 작업과 파일 관리</li>
                    <li style="margin-bottom: 8px;"><strong>Shift 키:</strong> 범위 선택과 데이터 입력</li>
                    <li style="margin-bottom: 8px;"><strong>Ctrl+Shift:</strong> 고급 기능과 대용량 데이터 처리</li>
                    <li style="margin-bottom: 8px;">단계적으로 익혀서 실무에 바로 적용</li>
                </ul>
                
                <h3>⚡ Excel 필수 단축키 Top 15</h3>
                <p style="margin-bottom: 15px;">Excel에서 가장 많이 사용되는 단축키들:</p>
                <ol style="margin-left: 20px; margin-bottom: 20px;">
                    <li style="margin-bottom: 5px;"><strong>Ctrl + S</strong> - 저장 (반드시 자주!)</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + C, V</strong> - 복사, 붙여넣기</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + Z</strong> - 실행 취소</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift + 방향키</strong> - 데이터 끝까지 선택</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + 1</strong> - 셀 서식</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + F</strong> - 찾기</li>
                    <li style="margin-bottom: 5px;"><strong>Shift + Space</strong> - 행 전체 선택</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + A</strong> - 전체 선택</li>
                    <li style="margin-bottom: 5px;"><strong>Shift + F11</strong> - 새 워크시트</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl + T</strong> - 표 만들기</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift+L</strong> - 자동 필터</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift+Enter</strong> - 배열 수식</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift+1~6</strong> - 숫자 서식</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift+9,0</strong> - 숨김 해제</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift+8</strong> - 영역 선택</li>
                </ol>
                
                <h3>💡 생산성 극대화 팁</h3>
                <p style="margin-bottom: 15px;">Excel 작업 효율을 극대화하는 비법:</p>
                <ul style="margin-left: 20px; margin-bottom: 20px;">
                    <li style="margin-bottom: 8px;"><strong>데이터 입력:</strong> Ctrl+D/R로 빠른 채우기</li>
                    <li style="margin-bottom: 8px;"><strong>범위 선택:</strong> Ctrl+Shift+End로 전체 데이터</li>
                    <li style="margin-bottom: 8px;"><strong>서식 지정:</strong> Ctrl+Shift+1~6으로 숫자 서식</li>
                    <li style="margin-bottom: 8px;"><strong>고급 편집:</strong> Ctrl+Shift+Enter로 배열 수식</li>
                    <li style="margin-bottom: 8px;"><strong>워크시트 관리:</strong> Ctrl+Shift+9,0으로 숨김 해제</li>
                </ul>

                <h3>🎮 단축키 모드 전환</h3>
                <p style="margin-bottom: 15px;">키보드 위의 모드 버튼으로 전환 가능:</p>
                <ul style="margin-left: 20px;">
                    <li style="margin-bottom: 5px;"><strong>Ctrl 모드:</strong> Ctrl 단축키만 표시</li>
                    <li style="margin-bottom: 5px;"><strong>Shift 모드:</strong> Shift 단축키만 표시</li>
                    <li style="margin-bottom: 5px;"><strong>Ctrl+Shift 모드:</strong> Ctrl+Shift 조합만 표시</li>
                    <li style="margin-bottom: 5px;"><strong>전체 모드:</strong> 모든 단축키 표시</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>📖 학습 자료</h4>
                <a href="#">통합 단축키 PDF</a>
                <a href="#">비디오 튜토리얼</a>
                <a href="#">연습 문제</a>
                <a href="#">Excel 함수 가이드</a>
            </div>
            <div class="footer-section">
                <h4>🔗 관련 링크</h4>
                <a href="#">Word 단축키</a>
                <a href="#">PowerPoint 단축키</a>
                <a href="#">Outlook 단축키</a>
                <a href="#">Windows 단축키</a>
            </div>
            <div class="footer-section">
                <h4>📞 고객 지원</h4>
                <a href="#">FAQ</a>
                <a href="#">문의하기</a>
                <a href="#">피드백</a>
                <a href="#">버그 신고</a>
            </div>
            <div class="footer-section">
                <h4>ℹ️ 회사 정보</h4>
                <a href="#">회사 소개</a>
                <a href="#">개인정보처리방침</a>
                <a href="#">이용약관</a>
                <a href="#">사이트맵</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Excel Integrated Shortcuts Guide. All rights reserved. | 연락처: info@excelshortcuts.com</p>
        </div>
    </footer>

    <script>
        let currentMode = 'ctrl';

        function showMode(mode) {
            currentMode = mode;
            
            // 모든 버튼에서 active 클래스 제거
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 선택된 버튼에 active 클래스 추가
            document.getElementById(mode + '-btn').classList.add('active');
            
            // 모든 키를 inactive로 변경
            document.querySelectorAll('.key').forEach(key => {
                if (!key.classList.contains('special-key')) {
                    key.classList.remove('ctrl-key', 'shift-key', 'ctrl-shift-key', 'both-key');
                    key.classList.add('inactive-key');
                }
            });
            
            // 모드에 따라 키 스타일 적용
            if (mode === 'ctrl') {
                // Ctrl 키만 표시
                applyCtrlKeys();
                updateInstructions('Ctrl 단축키가 표시됩니다. 초록색 키들을 확인하세요.');
            } else if (mode === 'shift') {
                // Shift 키만 표시
                applyShiftKeys();
                updateInstructions('Shift 단축키가 표시됩니다. 연두색 키들을 확인하세요.');
            } else if (mode === 'ctrl-shift') {
                // Ctrl+Shift 키만 표시
                applyCtrlShiftKeys();
                updateInstructions('Ctrl+Shift 단축키가 표시됩니다. 분홍색 키들을 확인하세요.');
            } else if (mode === 'all') {
                // 모든 키 표시
                applyAllKeys();
                updateInstructions('모든 단축키가 표시됩니다. 각 색상별로 확인하세요.');
            }
        }
        
        function applyCtrlKeys() {
            const ctrlKeys = [
                'F1', 'F2', 'F3', 'F4', 'F6', 'F10', 'F12',
                '1', '2', '3', '4', '5', '6', '9', '0', '-',
                'O', 'P', 'A', 'S', 'D', 'F', 'G', 'H', 'L',
                'Z', 'X', 'C', 'V', 'N',
                'Home', 'End', 'PgUp', 'PgDn',
                '↑', '↓', '←', '→'
            ];
            
            ctrlKeys.forEach(keyText => {
                const key = findKeyByText(keyText);
                if (key) {
                    key.classList.remove('inactive-key');
                    key.classList.add('ctrl-key');
                }
            });
        }
        
        function applyShiftKeys() {
            const shiftKeys = [
                'F1', 'F2', 'F3', 'F4', 'F5', 'F6', 'F7', 'F8', 'F9', 'F10', 'F11', 'F12',
                '1', '2', '3', '4', '5', '6', '9', '0', '-',
                'Tab', 'Enter', 'Z', 'C', 'V',
                'Home', 'End', 'PgUp', 'PgDn',
                '↑', '↓', '←', '→', 'Space'
            ];
            
            shiftKeys.forEach(keyText => {
                const key = findKeyByText(keyText);
                if (key) {
                    key.classList.remove('inactive-key');
                    key.classList.add('shift-key');
                }
            });
        }
        
        function applyCtrlShiftKeys() {
            const ctrlShiftKeys = [
                'F1', 'F2', 'F3', '~', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '-', '=',
                'Q', 'E', 'R', 'T', 'U', 'P', 'A', 'S', 'D', 'F', 'G', 'H', 'L',
                'Z', 'X', 'C', 'V', 'N',
                '↑', '↓', '←', '→', 'Space', 'Enter'
            ];
            
            ctrlShiftKeys.forEach(keyText => {
                const key = findKeyByText(keyText);
                if (key) {
                    key.classList.remove('inactive-key');
                    key.classList.add('ctrl-shift-key');
                }
            });
        }
        
        function applyAllKeys() {
            // 모든 키를 원래 상태로 복원
            document.querySelectorAll('.key').forEach(key => {
                key.classList.remove('inactive-key');
                
                // 원래 클래스 복원
                const keyText = key.textContent.split('\n')[0].trim();
                
                // Ctrl, Shift, Ctrl+Shift 모두 지원하는 키
                const bothKeys = [
                    'F1', 'F2', 'F3', 'F4', 'F6', 'F10', 'F12',
                    '1', '2', '3', '4', '5', '6', '9', '0', '-', '=',
                    'A', 'S', 'D', 'F', 'G', 'H', 'L',
                    'Z', 'X', 'C', 'V', 'N',
                    '↑', '↓', '←', '→', 'Home', 'End', 'PgUp', 'PgDn'
                ];
                
                // Ctrl+Shift만 지원하는 키
                const ctrlShiftOnly = ['~', '7', '8', 'Q', 'E', 'R', 'T', 'U', 'P'];
                
                // Shift만 지원하는 키
                const shiftOnly = ['F5', 'F7', 'F8', 'F9', 'F11', 'Tab', 'Enter'];
                
                // Ctrl만 지원하는 키
                const ctrlOnly = ['O'];
                
                if (bothKeys.includes(keyText)) {
                    key.classList.add('both-key');
                } else if (ctrlShiftOnly.includes(keyText)) {
                    key.classList.add('ctrl-shift-key');
                } else if (shiftOnly.includes(keyText)) {
                    key.classList.add('shift-key');
                } else if (ctrlOnly.includes(keyText)) {
                    key.classList.add('ctrl-key');
                } else if (!key.classList.contains('special-key')) {
                    key.classList.add('inactive-key');
                }
            });
        }
        
        function findKeyByText(text) {
            const keys = document.querySelectorAll('.key');
            for (let key of keys) {
                const keyText = key.textContent.split('\n')[0].trim();
                if (keyText === text) {
                    return key;
                }
            }
            return null;
        }
        
        function updateInstructions(text) {
            document.getElementById('instructions').textContent = text;
        }
        
        function openModal() {
            document.getElementById('helpModal').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('helpModal').classList.remove('active');
        }
        
        // 검색 기능
        document.querySelector('.search-input').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const keys = document.querySelectorAll('.key');
            
            if (searchTerm === '') {
                // 검색어가 없으면 현재 모드로 복원
                showMode(currentMode);
                return;
            }
            
            // 모든 키를 비활성화
            keys.forEach(key => {
                if (!key.classList.contains('special-key')) {
                    key.classList.remove('ctrl-key', 'shift-key', 'ctrl-shift-key', 'both-key');
                    key.classList.add('inactive-key');
                    
                    // 툴팁에서 검색
                    const tooltip = key.querySelector('.tooltip');
                    if (tooltip && tooltip.textContent.toLowerCase().includes(searchTerm)) {
                        key.classList.remove('inactive-key');
                        key.classList.add('ctrl-key'); // 검색 결과는 초록색으로 표시
                    }
                    
                    // 키 텍스트에서 검색
                    const keyText = key.textContent.toLowerCase();
                    if (keyText.includes(searchTerm)) {
                        key.classList.remove('inactive-key');
                        key.classList.add('ctrl-key');
                    }
                }
            });
            
            updateInstructions(`"${searchTerm}" 검색 결과입니다. 일치하는 단축키가 초록색으로 표시됩니다.`);
        });
        
        // 키보드 이벤트 처리
        document.addEventListener('keydown', function(e) {
            // Ctrl, Shift 키 조합 감지
            if (e.ctrlKey && e.shiftKey) {
                showMode('ctrl-shift');
            } else if (e.ctrlKey) {
                showMode('ctrl');
            } else if (e.shiftKey) {
                showMode('shift');
            }
        });
        
        document.addEventListener('keyup', function(e) {
            // 키를 놓으면 전체 보기로 복원 (선택사항)
            // showMode('all');
        });
        
        // 모달 외부 클릭시 닫기
        document.getElementById('helpModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // ESC 키로 모달 닫기
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // 페이지 로드시 기본 모드 설정
        document.addEventListener('DOMContentLoaded', function() {
            showMode('ctrl');
        });
        
        // 터치 디바이스 지원
        if ('ontouchstart' in window) {
            document.querySelectorAll('.key').forEach(key => {
                key.addEventListener('touchstart', function() {
                    this.classList.add('active');
                });
                
                key.addEventListener('touchend', function() {
                    this.classList.remove('active');
                });
            });
        }
        
        // 키보드 접근성 지원
        document.querySelectorAll('.key, .mode-btn, .sidebar-item').forEach(element => {
            element.addEventListener('focus', function() {
                this.style.outline = '2px solid #2ECC71';
            });
            
            element.addEventListener('blur', function() {
                this.style.outline = 'none';
            });
        });
        
        // 애니메이션 효과
        function animateKeys() {
            const keys = document.querySelectorAll('.key:not(.inactive-key):not(.special-key)');
            keys.forEach((key, index) => {
                setTimeout(() => {
                    key.style.transform = 'translateY(-5px)';
                    setTimeout(() => {
                        key.style.transform = 'translateY(0)';
                    }, 200);
                }, index * 50);
            });
        }
        
        // 모드 변경시 애니메이션 실행
        const originalShowMode = showMode;
        showMode = function(mode) {
            originalShowMode(mode);
            setTimeout(animateKeys, 100);
        };
        
        // 스크롤 효과
        window.addEventListener('scroll', function() {
            const header = document.querySelector('.header');
            if (window.scrollY > 100) {
                header.style.background = 'rgba(255, 255, 255, 0.2)';
            } else {
                header.style.background = 'rgba(255, 255, 255, 0.1)';
            }
        });
        
        // 다크모드 토글 (선택사항)
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            // 다크모드 설정을 로컬 스토리지에 저장하지 않음 (Claude 제약사항)
        }
        
        // 인쇄 기능
        function printShortcuts() {
            window.print();
        }
        
        // PDF 다운로드 시뮬레이션
        function downloadPDF() {
            alert('PDF 다운로드 기능은 실제 서버 환경에서 구현됩니다.');
        }
        
        // 성능 최적화 - 디바운싱
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // 검색 입력 디바운싱 적용
        const debouncedSearch = debounce(function(searchTerm) {
            // 검색 로직은 이미 위에 구현됨
        }, 300);
        
        // 키보드 단축키 도움말
        function showKeyboardHelp() {
            const helpText = `
            🎯 키보드 단축키 가이드:
            
            ⌨️ 기본 조작:
            • Tab: 다음 요소로 이동
            • Enter: 선택/실행
            • ESC: 모달 닫기
            • 방향키: 키보드 내비게이션
            
            🔍 검색:
            • Ctrl+F: 페이지 내 검색
            • /: 단축키 검색 (포커스)
            
            🎮 모드 전환:
            • 1: Ctrl 모드
            • 2: Shift 모드
            • 3: Ctrl+Shift 모드
            • 4: 전체 모드
            `;
            
            alert(helpText);
        }
        
        // 전역 키보드 단축키
        document.addEventListener('keydown', function(e) {
            // 모달이 열려있거나 입력 필드에 포커스가 있으면 무시
            if (document.getElementById('helpModal').classList.contains('active') || 
                document.activeElement.tagName === 'INPUT') {
                return;
            }
            
            switch(e.key) {
                case '1':
                    e.preventDefault();
                    showMode('ctrl');
                    break;
                case '2':
                    e.preventDefault();
                    showMode('shift');
                    break;
                case '3':
                    e.preventDefault();
                    showMode('ctrl-shift');
                    break;
                case '4':
                    e.preventDefault();
                    showMode('all');
                    break;
                case '/':
                    e.preventDefault();
                    document.querySelector('.search-input').focus();
                    break;
                case '?':
                    e.preventDefault();
                    showKeyboardHelp();
                    break;
                case 'h':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        openModal();
                    }
                    break;
            }
        });
        
        // 툴팁 개선 - 모바일 대응
        if (window.innerWidth <= 768) {
            document.querySelectorAll('.key').forEach(key => {
                key.addEventListener('click', function() {
                    const tooltip = this.querySelector('.tooltip');
                    if (tooltip) {
                        // 모바일에서는 클릭시 알림으로 표시
                        alert(tooltip.textContent.replace(/<br>/g, '\n'));
                    }
                });
            });
        }
        
        // 접근성 향상 - 스크린 리더 지원
        document.querySelectorAll('.key').forEach(key => {
            const tooltip = key.querySelector('.tooltip');
            if (tooltip) {
                key.setAttribute('aria-label', tooltip.textContent);
                key.setAttribute('role', 'button');
                key.setAttribute('tabindex', '0');
            }
        });
        
        // 사용자 경험 개선 - 진동 피드백 (모바일)
        function vibrate(duration = 50) {
            if (navigator.vibrate) {
                navigator.vibrate(duration);
            }
        }
        
        document.querySelectorAll('.key, .mode-btn').forEach(element => {
            element.addEventListener('click', () => vibrate());
        });
        
        // 마지막으로 초기화
        console.log('🎯 Excel 통합 단축키 키보드가 로드되었습니다!');
        console.log('💡 도움말: ? 키를 눌러 키보드 단축키 가이드를 확인하세요.');
    </script>
</body>
</html>